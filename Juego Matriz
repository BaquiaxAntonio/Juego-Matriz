import random
import time

def generar_tablero(n):
    tablero = []
    for _ in range(n):
        fila = [random.randint(0, 11) for _ in range(n)]
        tablero.append(fila)
    return tablero

def mostrar_tablero(tablero, oculto):
    n = len(tablero)
    for i in range(n):
        for j in range(n):
            if oculto[i][j]:
                print("?", end=" ")
            else:
                print(tablero[i][j], end=" ")
        print()

def mostrar_vecinos(tablero, oculto, fila, columna):
    n = len(tablero)
    for i in range(fila - 1, fila + 2):
        for j in range(columna - 1, columna + 2):
            if 0 <= i < n and 0 <= j < n and not oculto[i][j]:
                print(tablero[i][j], end=" ")
            else:
                print("?", end=" ")
        print()

def calcular_resultado(tablero, fila, columna):
    n = len(tablero)
    suma = 0
    for i in range(fila - 1, fila + 2):
        for j in range(columna - 1, columna + 2):
            if 0 <= i < n and 0 <= j < n:
                suma += tablero[i][j]
    resultado = suma * tablero[fila][columna]
    return resultado

def mostrar_respuestas(respuestas):
    for i, respuesta in enumerate(respuestas):
        print(f"{i + 1}. {respuesta}")

def jugar():
    # Configuración inicial
    n = int(input("Ingrese el tamaño del tablero (N x N): "))
    tablero = generar_tablero(n)
    oculto = [[True] * n for _ in range(n)]
    nombres = [input("Ingrese el nombre del jugador 1: "), input("Ingrese el nombre del jugador 2: ")]
    puntajes = [0, 0]
    participaciones = int(input("Ingrese la cantidad de participaciones por jugador: "))

    # Juego
    for participacion in range(participaciones):
        print(f"\n----- Participación {participacion + 1} -----")
        for jugador in range(2):
            print(f"\nTurno de {nombres[jugador]}")
            mostrar_tablero(tablero, oculto)
            fila = int(input("Ingrese la fila: "))
            columna = int(input("Ingrese la columna: "))
            oculto[fila][columna] = False
            mostrar_vecinos(tablero, oculto, fila, columna)
            tiempo_inicial = time.time()
            tiempo_limite = tiempo_inicial + 25
            while time.time() < tiempo_limite:
                tiempo_restante = int(tiempo_limite - time.time())
                print(f"Tiempo restante: {tiempo_restante} segundos")
                respuesta = int(input("Ingrese el número de la respuesta correcta: "))
                resultado = calcular_resultado(tablero, fila, columna)
                if respuesta == resultado:
                    print("¡Respuesta correcta! +3 puntos\n")
                    puntajes[jugador] += 3
                    break
                else:
                    print("Respuesta incorrecta. Sigue intentando.")
            else:
                print("¡Tiempo agotado! No se acumulan puntos en este turno.\n")

    # Resultado final
    print("\n----- Resultado Final -----")
    print(f"Puntaje de {nombres[0]}: {puntajes[0]}")
    print(f"Puntaje de {nombres[1]}: {puntajes[1]}")
    if puntajes[0] > puntajes[1]:
        print(f"\n¡{nombres[0]} es el ganador!")
    elif puntajes[1] > puntajes[0]:
        print(f"\n¡{nombres[1]} es el ganador!")
    else:
        print("\n¡Empate!")

# Ejecutar el juego
jugar()
